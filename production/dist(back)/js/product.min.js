let select,specialsArr=[],brand=item_result.param["Бренд"],type=item_result.param["Тип велосипеда"],year=item_result.param["Модельный год"],frame=item_result.param["Материал рамы"],vendorCode=item_result.vendorCode,price=item_result.price[0];function specialsParser(){let e=[];if(item_id.sort(ASC),specialsArr=item_id,specialsArr.length>20){e=[];for(let t=0;t<specialsArr.length;t++){const r=specialsArr[t];r.param["Тип велосипеда"]==type&&e.push(r)}specialsArr=e}if(specialsArr.length>20){let t;e=[],tmpCounter=[];for(let e=0;e<specialsArr.length;e++){specialsArr[e].vendorCode==vendorCode&&(t=e)}let r=t-10,a=t+10;r<0&&(a+=-1*r),a>specialsArr.length&&(r=r-(a-specialsArr.length)-1);for(let c=0;c<specialsArr.length;c++){const s=specialsArr[c];c>=r&&c<=a&&c!=t&&e.push(s)}specialsArr=e}}function buildSpecials(){let e=document.querySelector(".specials-product");e.innerHTML="";for(let t=0;t<specialsArr.length;t++){const r=specialsArr[t];let a=r.vendorCode,c=r.picture,s=r.name,l=r.price[0],i=document.createElement("div");for(key in i.classList.add("specials-product__item"),i.innerHTML=`\n                        <div class="catalog-item">\n                           <div class="catalog-item__img img-catalog">\n                              <div class="img-catalog__wrapper">\n                                 <a class="img-catalog__link" href="?route=veloparking/product&amp;id=${a}">\n                                    <img class="img-catalog__img swiper-lazy" src="${lazyImage}" data-src="${c}" alt="">\n                                    <div class="img-catalog__stickers stickers">\n                                    </div>\n                                 </a>\n                              </div>\n                           </div>\n                           <div class="catalog-item__info info-catalog">\n                              <div class="info-catalog__line">\n                                 <a href="?route=veloparking/product&amp;id=${a}" class="info-catalog__name">${s}</a>\n                              </div>\n                              <div class="info-catalog__line">\n                                 <div class="info-catalog__price _price">${l} <span class="_rub"></span></div>\n                                 <a href="?route=veloparking/product&amp;id=${a}" class="info-catalog__link main__button">Подробнее</a>\n                              </div>\n                           </div>\n                        </div>\n      `,stickers)stickers[key].forEach(e=>{if(e==a){let e=i.querySelector(".img-catalog__stickers"),t=document.createElement("div");t.classList.add("stickers__sticker"),t.classList.add("stickers__"+key),e.appendChild(t)}});e.appendChild(i)}swiperBuild(),specialsInit(),halfedPrice()}function buildCharacter(){let e=document.querySelector(".character__body"),t=document.createElement("button");t.classList.add("main__button"),t.classList.add("character__submit"),t.classList.add("_popup-close__user"),t.innerHTML="Подтвердить",e.innerHTML='\n                     <div class="popup__close _icon-close"></div>\n                     <h2 class="character__title">Выберите характеристику товара</h2>\n                     <select>\n                        <option value="0" selected="selected">Не выбрано</option>\n                     </select>';for(let t=0;t<item_result.size.length;t++){const r=item_result.size[t];let a=document.createElement("option");a.setAttribute("value",r),a.innerHTML=r,e.querySelector("select").appendChild(a)}selectInit(),popupInit(),e.appendChild(t)}function listenSelectOption(){let e=document.querySelector(".character__submit");function t(){let t=document.querySelector(".character").querySelectorAll("option");for(let r=0;r<t.length;r++){const a=t[r];a.selected&&("0"!==a.getAttribute("value")?(e.classList.remove("_disable"),select=a.getAttribute("value")):e.classList.add("_disable"))}}t(),document.querySelector(".character").addEventListener("click",()=>{t()})}function addToCart(){let e=document.querySelector(".character__submit"),t=document.querySelector(".character").querySelectorAll("option");for(let e=0;e<t.length;e++){const r=t[e];r.selected&&(select=r.getAttribute("value"))}e.addEventListener("click",()=>{e.closest(".popup").classList.remove("_active"),history.pushState("","",window.location.href.split("#")[0]),body_lock_remove(500),saveToCart(vendorCode,select),checkInsertCart(),syncStorageSQL()})}function checkInsertCart(){if(localStorage.cart){let e=document.querySelector("._popup_character__open").closest(".product-item__row"),t=JSON.parse(localStorage.getItem("cart")),r=Object.keys(t);for(let a=1;a<=r.length;a++){const r=Object.keys(t[a])[0];vendorCode==r&&(e.classList.add("product-item__to-cart"),modifyButton(),bageCart())}}}function modifyButton(){let e=document.querySelector(".product-item__to-cart"),t=JSON.parse(localStorage.getItem("cart")),r=Object.keys(t),a=0;for(let e=1;e<=r.length;e++){const r=Object.keys(t[e])[0];vendorCode==r&&a++}e.innerHTML="";let c=document.createElement("a");c.classList.add("product-item__link"),c.classList.add("_popup-link"),c.setAttribute("href","cart"),c.innerHTML=`В корзине ${a} шт.\n                     <span>Перейти в корзину</span>`;let s=document.createElement("a");s.classList.add("product-item__count"),s.classList.add("_popup-link"),s.classList.add("_popup_character__open"),s.setAttribute("href","#character"),s.innerHTML="+1 шт.",e.appendChild(c),e.appendChild(s),popupInit()}specialsParser(),buildSpecials(),buildCharacter(),listenSelectOption(),addToCart(),checkInsertCart();